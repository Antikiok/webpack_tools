(()=>{"use strict";const t=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},e=t=>JSON.parse(localStorage.getItem(t)),s=document.querySelector(".list"),n=(t,e)=>t.done-e.done,a=({text:t,done:e,id:s})=>{const n=document.createElement("li");n.classList.add("list__item");const a=(({done:t,id:e})=>{const s=document.createElement("input");return s.setAttribute("type","checkbox"),s.checked=t,s.classList.add("list__item-checkbox"),s.setAttribute("data-id",e),s})({done:e,id:s}),i=document.createElement("span");e&&(n.classList.add("list__item_done"),i.classList.add("list__item-text")),i.textContent=t;const c=document.createElement("button");return c.classList.add("list__item_delete-btn"),c.setAttribute("data-id",s),n.append(a,i,c),n},i=()=>{const t=e("tasksList")||[];s.innerHTML="";const i=t.sort(n).map(a);s.append(...i)},c="https://614ffa90a706cd00179b734a.mockapi.io/users",d=()=>fetch(c).then((t=>t.json())).then((t=>(t=>t.map((({id:t,...e})=>({...e,id:t}))))(t))),o=()=>{const e=document.querySelector(".task-input"),s=e.value;if(!s)return;e.value="";var n;(n={text:s,done:!1,createDate:(new Date).toISOString()},fetch(c,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)})).then((()=>d())).then((e=>{t("tasksList",e),i()}))},r=s=>{const n=s.target.classList.contains("list__item-checkbox"),a=s.target.classList.contains("list__item_delete-btn"),o=s.target.dataset.id,r=e("tasksList"),{text:l,createDate:u}=r.find((t=>t.id===o)),m=s.target.checked,h={text:l,createDate:u,done:m,finishDate:m?(new Date).toISOString():null};n&&((t,e)=>fetch(`${c}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}))(o,h).then((()=>d())).then((e=>{t("tasksList",e),i()})),a&&(t=>fetch(`${c}/${t}`,{method:"DELETE"}))(o).then((()=>d())).then((e=>{t("tasksList",e),i()}))};document.addEventListener("DOMContentLoaded",(()=>{d().then((e=>{t("tasksList",e),i()})),document.querySelector(".create-task-btn").addEventListener("click",o),document.querySelector(".list").addEventListener("click",r)})),window.addEventListener("storage",(t=>{"tasksList"===t.key&&i()}))})();